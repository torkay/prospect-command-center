<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prospect Scraper</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/app/style.css">
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen font-mono">
    <div class="max-w-6xl mx-auto p-4">

        <!-- Header -->
        <header class="flex items-center justify-between py-4 border-b border-gray-700">
            <h1 class="text-xl font-bold text-green-400">prospect-scraper</h1>
            <div class="flex items-center gap-4 text-sm">
                <span id="status-serpapi" class="text-gray-500" title="SerpAPI status">&#9679;</span>
                <span id="status-sheets" class="text-gray-500" title="Sheets status">&#9679;</span>
                <a href="/docs" target="_blank" class="text-blue-400 hover:underline">API Docs</a>
                <span id="version" class="text-gray-500">v0.0.0</span>
            </div>
        </header>

        <!-- Main Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mt-4">

            <!-- Left: Search Form -->
            <div class="lg:col-span-1 space-y-4">
                <div class="bg-gray-800 rounded p-4">
                    <h2 class="text-sm text-gray-400 mb-3">NEW SEARCH</h2>

                    <form id="search-form" class="space-y-3">
                        <div>
                            <label class="block text-xs text-gray-500 mb-1">BUSINESS TYPE</label>
                            <input type="text" name="business_type"
                                   placeholder="buyer's agent"
                                   class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-sm focus:border-green-400 focus:outline-none"
                                   required>
                        </div>

                        <div>
                            <label class="block text-xs text-gray-500 mb-1">LOCATION</label>
                            <input type="text" name="location"
                                   placeholder="Brisbane, QLD"
                                   class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-sm focus:border-green-400 focus:outline-none"
                                   required>
                        </div>

                        <div class="grid grid-cols-2 gap-2">
                            <div>
                                <label class="block text-xs text-gray-500 mb-1">LIMIT</label>
                                <input type="number" name="limit" value="20" min="1" max="100"
                                       class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-sm focus:border-green-400 focus:outline-none">
                            </div>
                            <div>
                                <label class="block text-xs text-gray-500 mb-1">PARALLEL</label>
                                <input type="number" name="parallel" value="3" min="1" max="10"
                                       class="w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-sm focus:border-green-400 focus:outline-none">
                            </div>
                        </div>

                        <!-- Collapsible Filters -->
                        <details class="text-sm">
                            <summary class="text-gray-400 cursor-pointer hover:text-gray-300">Filters</summary>
                            <div class="mt-2 space-y-2 pl-2 border-l border-gray-700">
                                <div class="grid grid-cols-3 gap-2">
                                    <div>
                                        <label class="block text-xs text-gray-500">MIN FIT</label>
                                        <input type="number" name="min_fit" value="0" min="0" max="100"
                                               class="w-full bg-gray-700 border border-gray-600 rounded px-2 py-1 text-sm">
                                    </div>
                                    <div>
                                        <label class="block text-xs text-gray-500">MIN OPP</label>
                                        <input type="number" name="min_opportunity" value="0" min="0" max="100"
                                               class="w-full bg-gray-700 border border-gray-600 rounded px-2 py-1 text-sm">
                                    </div>
                                    <div>
                                        <label class="block text-xs text-gray-500">MIN PRI</label>
                                        <input type="number" name="min_priority" value="0" min="0" max="100"
                                               class="w-full bg-gray-700 border border-gray-600 rounded px-2 py-1 text-sm">
                                    </div>
                                </div>
                                <div class="flex gap-4">
                                    <label class="flex items-center gap-2 text-gray-400">
                                        <input type="checkbox" name="require_phone" class="rounded">
                                        Phone
                                    </label>
                                    <label class="flex items-center gap-2 text-gray-400">
                                        <input type="checkbox" name="require_email" class="rounded">
                                        Email
                                    </label>
                                    <label class="flex items-center gap-2 text-gray-400">
                                        <input type="checkbox" name="skip_enrichment" class="rounded">
                                        Fast
                                    </label>
                                </div>
                            </div>
                        </details>

                        <button type="submit"
                                class="w-full bg-green-600 hover:bg-green-500 text-white font-bold py-2 rounded transition"
                                id="submit-btn">
                            <span id="submit-text">Search</span>
                            <span id="submit-loading" class="hidden">Searching...</span>
                        </button>
                    </form>
                </div>

                <!-- Jobs List -->
                <div class="bg-gray-800 rounded p-4">
                    <h2 class="text-sm text-gray-400 mb-3">RECENT JOBS</h2>
                    <div id="jobs-list" class="space-y-2 text-sm max-h-64 overflow-y-auto">
                        <p class="text-gray-500 text-xs">No jobs yet</p>
                    </div>
                </div>
            </div>

            <!-- Right: Results -->
            <div class="lg:col-span-2">
                <div class="bg-gray-800 rounded p-4">
                    <!-- Progress -->
                    <div id="progress-container" class="hidden mb-4">
                        <div class="flex justify-between text-sm text-gray-400 mb-1">
                            <span id="progress-message">Searching...</span>
                            <span id="progress-count">0/0</span>
                        </div>
                        <div class="h-2 bg-gray-700 rounded overflow-hidden">
                            <div id="progress-bar" class="h-full bg-green-500 transition-all" style="width: 0%"></div>
                        </div>
                    </div>

                    <!-- Results Header -->
                    <div id="results-header" class="hidden flex justify-between items-center mb-4">
                        <div>
                            <span id="results-count" class="text-lg font-bold text-green-400">0</span>
                            <span class="text-gray-400">prospects</span>
                            <span id="results-stats" class="text-sm text-gray-500 ml-2"></span>
                        </div>
                        <div class="flex gap-2">
                            <button id="export-csv" class="px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded text-sm">CSV</button>
                            <button id="export-json" class="px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded text-sm">JSON</button>
                            <button id="export-sheets" class="px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded text-sm">Sheets</button>
                        </div>
                    </div>

                    <!-- Results Table -->
                    <div id="results-table" class="overflow-x-auto">
                        <table class="w-full text-sm">
                            <thead class="text-left text-gray-400 border-b border-gray-700">
                                <tr>
                                    <th class="pb-2 cursor-pointer hover:text-white" data-sort="name">Name</th>
                                    <th class="pb-2 cursor-pointer hover:text-white" data-sort="fit_score">Fit</th>
                                    <th class="pb-2 cursor-pointer hover:text-white" data-sort="opportunity_score">Opp</th>
                                    <th class="pb-2 cursor-pointer hover:text-white" data-sort="priority_score">Pri</th>
                                    <th class="pb-2">Contact</th>
                                    <th class="pb-2">Notes</th>
                                </tr>
                            </thead>
                            <tbody id="results-body">
                            </tbody>
                        </table>
                    </div>

                    <!-- Empty State -->
                    <div id="empty-state" class="text-center py-12 text-gray-500">
                        <p>No results yet. Run a search to find prospects.</p>
                        <p class="text-sm mt-2">Keyboard: <kbd class="bg-gray-700 px-1 rounded">/</kbd> to focus search</p>
                    </div>
                </div>

                <!-- Raw Data Panel -->
                <details class="mt-4 bg-gray-800 rounded">
                    <summary class="p-4 text-sm text-gray-400 cursor-pointer hover:text-gray-300">Raw Data</summary>
                    <pre id="raw-data" class="p-4 text-xs overflow-x-auto max-h-64 bg-gray-900 rounded-b">{}</pre>
                </details>
            </div>
        </div>

        <!-- Keyboard Shortcuts -->
        <footer class="mt-8 py-4 border-t border-gray-700 text-xs text-gray-500">
            <span class="mr-4"><kbd class="bg-gray-700 px-1 rounded">/</kbd> Search</span>
            <span class="mr-4"><kbd class="bg-gray-700 px-1 rounded">Esc</kbd> Clear</span>
            <span class="mr-4"><kbd class="bg-gray-700 px-1 rounded">j</kbd>/<kbd class="bg-gray-700 px-1 rounded">k</kbd> Navigate</span>
            <span><kbd class="bg-gray-700 px-1 rounded">e</kbd> Export</span>
        </footer>
    </div>

    <script src="/app/app.js"></script>
</body>
</html>
